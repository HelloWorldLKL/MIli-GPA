var colClassName=document.querySelector("#col-class-name");var colPoint=document.querySelector("#col-point");var colCredit=document.querySelector("#col-credit");
var calculateBtn=document.querySelector("#calculate-btn");var addNewBtn=document.querySelector("#add-new-btn");var deleteBtn=document.querySelector("#delete-a-btn");
var resetBtn=document.querySelector("#reset-btn");var questionBtn=document.querySelector("#question-btn");var connectBtn=document.querySelector("#connect-with-me");
var answerModel=document.querySelector("#answer-dialog .modal-body p");var titleModel=document.querySelector("#answer-dialog .modal-title");window.onload=function(){addNewBtn.addEventListener("click",addNewItem,false);
deleteBtn.addEventListener("click",removeItem,false);resetBtn.addEventListener("click",resetItem,false);questionBtn.addEventListener("click",callHelpDialog,false);
calculateBtn.addEventListener("click",calculateGPA,false);connectBtn.addEventListener("click",callFeedbackDialog,false);colPoint.addEventListener("focusout",testInput(0,100),false);
colCredit.addEventListener("focusout",testInput(0,10),false);};function addNewItem(){event.preventDefault();if(deleteBtn.hasAttribute("disabled")){deleteBtn.removeAttribute("disabled");
}var d=colClassName.lastElementChild.firstElementChild.placeholder.substr(2);var c=document.createElement("div");c.className="form-group has-feedback";
c.innerHTML='<input type="text" class="form-control input-sm"placeholder="&#x8BFE;&#x7A0B;'+(parseInt(d)+1)+'">';var b=document.createElement("div");b.className="form-group has-feedback";
b.innerHTML='<input type="text" class="form-control input-sm"><span></span>';var a=document.createElement("div");a.className="form-group has-feedback";
a.innerHTML='<input type="text" class="form-control input-sm"><span></span>';colClassName.appendChild(c);colPoint.appendChild(b);colCredit.appendChild(a);
}function removeItem(a){a.preventDefault();colClassName.removeChild(colClassName.lastElementChild);colPoint.removeChild(colPoint.lastElementChild);colCredit.removeChild(colCredit.lastElementChild);
if(colClassName.children.length===1){deleteBtn.disabled="disabled";}}function resetItem(c){var d=document.querySelectorAll("#col-point input");var b=document.querySelectorAll("#col-credit input");
for(var a=0;a<colClassName.children.length;a++){d[a].parentElement.className="form-group has-feedback";d[a].parentElement.lastElementChild.className="";
b[a].parentElement.className="form-group has-feedback";b[a].parentElement.lastElementChild.className="";}}function getGpaFromPoint(b){var a=0;switch(true){case (b<=100)&&(b>=90):a=4;
break;case (b<90)&&(b>=85):a=3.7;break;case (b<85)&&(b>=82):a=3.3;break;case (b<82)&&(b>=78):a=3;break;case (b<78)&&(b>=75):a=2.7;break;case (b<75)&&(b>=72):a=2.3;
break;case (b<72)&&(b>=68):a=2;break;case (b<68)&&(b>=66):a=1.7;break;case (b<66)&&(b>=64):a=1.5;break;case (b<64)&&(b>=60):a=1;break;case (b<60)&&(b>=0):a=0;
break;default:a=-1;break;}return a;}function testInput(b,a){return function(){var d=window.event,c=d.srcElement?d.srcElement:d.target;if(c.nodeName=="INPUT"){if(isNaN(parseInt(c.value))||c.value<b||c.value>a){c.parentElement.className="form-group has-error has-feedback";
c.parentElement.lastElementChild.className="glyphicon glyphicon-remove form-control-feedback";}else{c.parentElement.className="form-group has-feedback";
c.parentElement.lastElementChild.className="";}}};}function getInputArr(a){return function(){var c=document.querySelectorAll(a+" input");var b=[];for(var d=0;
d<c.length;d++){if(c[d].value===""){b.push(undefined);}else{b.push(parseInt(c[d].value,10));}}return b;};}function calculateGPA(f){f.preventDefault();var e=0;
var b=1;var a=0;var g=0;var d=getInputArr("#col-point")();var c=getInputArr("#col-credit")();for(e=0;e<colClassName.children.length;e++){if(d[e]==undefined&&c[e]==undefined){continue;
}if(colPoint.children[e].classList.contains("has-error")||colCredit.children[e].classList.contains("has-error")){b=0;break;}a+=(getGpaFromPoint(d[e])*c[e]);
g+=c[e];}if(b==0||isNaN(((a/g).toFixed(2)))){titleModel.innerHTML="查询失败";answerModel.innerHTML="请检查您的数据的有效性";}else{titleModel.innerHTML="查询成功";answerModel.innerHTML="您的平均学分绩点为"+((a/g).toFixed(2));
}$("#answer-dialog").modal("show");}function callHelpDialog(a){a.preventDefault();$("#help-dialog").modal("show");}function callFeedbackDialog(a){a.preventDefault();
$("#feedback-dialog").modal("show");}